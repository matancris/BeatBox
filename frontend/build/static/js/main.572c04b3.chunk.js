(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{136:function(e,t,n){e.exports=n.p+"static/media/equalizer5.d1a782b3.gif"},149:function(e,t,n){e.exports=n.p+"static/media/logo.2df3552c.png"},174:function(e,t,n){e.exports=n.p+"static/media/idan.37498da7.jpeg"},175:function(e,t,n){e.exports=n.p+"static/media/hilla.6642151d.jpg"},176:function(e,t,n){e.exports=n.p+"static/media/matan.81bc655c.jpg"},199:function(e,t,n){e.exports=n(393)},289:function(e,t){},382:function(e,t,n){e.exports=n.p+"static/media/hero3.c4b78485.jpg"},383:function(e,t,n){e.exports=n.p+"static/media/hero2.526a0b37.png"},384:function(e,t,n){e.exports=n.p+"static/media/hero1.e3df7b57.jpg"},391:function(e,t,n){e.exports=n.p+"static/media/box.6a7fc70a.png"},392:function(e,t,n){},393:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),s=n.n(o),c=n(15),i=n(32),l=n(154),u=n(29),p=n(4),m=n(2),d=n.n(m),f=n(3),g=n(60),h=n.n(g),b=h.a.create({withCredentials:!0}),v=function(e,t){return S(e,"GET",t)},x=function(e,t){return S(e,"POST",t)},E=function(e,t){return S(e,"PUT",t)},y=function(e,t){return S(e,"DELETE",t)};function S(e){return O.apply(this,arguments)}function O(){return(O=Object(f.a)(d.a.mark((function e(t){var n,a,r,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"get",a=o.length>2&&void 0!==o[2]?o[2]:null,e.prev=2,e.next=5,b({url:"".concat("/api/").concat(t),method:n,data:a});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(n,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(a)),console.dir(e.t0),e.t0.response&&401===e.t0.response.status&&window.location.assign("/"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var w=n(155),j=n.n(w),k="https://www.googleapis.com/youtube/v3/search",N="https://www.googleapis.com/youtube/v3/videos",C="AIzaSyBqervqI1bhI7zmxR4tQEadbG8h_6pXIek",B={get:function(e){return U.apply(this,arguments)},titleSimplify:function(e){var t=j.a.decode(e);return t=t.replace(/[([].?(official.?video)?(official music video)?.?[)\]]/gi,"")},getDuration:function(e,t){return D.apply(this,arguments)},getSongById:function(e){return R.apply(this,arguments)}};function U(){return(U=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("get -> API_KEYS[gCurrApiKey]",C),e.next=4,h.a.get("".concat(k,"?videoCategoryId=10&part=id,snippet&videoEmbeddable=true&type=video&maxResults=10&q=").concat(t,"&key=").concat(C));case 4:return n=e.sent,e.abrupt("return",n.data);case 8:e.prev=8,e.t0=e.catch(0),console.dir(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function R(){return(R=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("".concat(N,"?id=").concat(t,"&part=id,contentDetails,snippet&key=").concat(C));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:throw e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function D(){return(D=Object(f.a)(d.a.mark((function e(t,n){var a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=14;break}return e.prev=1,e.next=4,h.a.get("".concat(N,"?id=").concat(t,"&part=contentDetails&key=").concat(C));case 4:r=e.sent,a=r.data.items[0].contentDetails.duration,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),console.log(e.t0),e.t0;case 12:e.next=15;break;case 14:a=n;case 15:return e.prev=15,(a=(a=(a=a.substring(2)).replace("M",":")).split(":"))[1]=a[1].replace("S",""),a[1]=a[1].padStart(2,"0"),a=a.join(":"),e.abrupt("return",a.toString());case 25:return e.prev=25,e.t1=e.catch(15),e.abrupt("return",null);case 28:case"end":return e.stop()}}),e,null,[[1,8],[15,25]])})))).apply(this,arguments)}var I=["Hip-hop","Easy","Electronic","Latin","Rock","Pop","Classical","Alternative","Blues","Disco","Israeli","Arabic"],M={query:function(e){return _.apply(this,arguments)},getById:function(e){return T.apply(this,arguments)},getAllGenres:function(){return I},getUsedGenres:function(e){var t=[];return e.forEach((function(e){t.push(e.genre)})),Object(u.a)(new Set(t))},save:function(e){return P.apply(this,arguments)},update:function(e){return A.apply(this,arguments)},addSong:function(e){return F.apply(this,arguments)},getEmptyBox:function(e){return{name:"",description:"",imgUrl:null,genre:"",createdBy:e,songs:[]}},remove:function(e){return G.apply(this,arguments)}};function T(){return(T=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v("box/".concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t||"",e.next=3,v("box".concat(t));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("box",t);case 2:return n=e.sent,W.addBoxToUser(n._id),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E("box/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(f.a)(d.a.mark((function e(t){var n,a,r,o,s=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]&&s[1],r=a?t.id:t.id.videoId,e.t0=L(),e.t1=r,e.t2=B.titleSimplify(t.snippet.title),e.next=7,B.getDuration(t.id.videoId,null===(n=t.contentDetails)||void 0===n?void 0:n.duration);case 7:return e.t3=e.sent,e.t4=t.snippet.thumbnails.high.url,o={id:e.t0,youtubeId:e.t1,title:e.t2,duration:e.t3,imgUrl:e.t4},e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function G(){return(G=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y("box/".concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W={login:function(e){return H.apply(this,arguments)},signup:function(e){return z.apply(this,arguments)},logout:function(){return X.apply(this,arguments)},getUser:q,getMinimalUser:function(){var e=q();return{name:e.username,imgUrl:e.imgUrl,id:e._id}},addBoxToUser:function(e){return Z.apply(this,arguments)},getUserBoxes:function(e){return ee.apply(this,arguments)},getUserById:K,removeBoxFromUser:function(e){return $.apply(this,arguments)},toggleToFavorite:function(e){return te.apply(this,arguments)},getUserFavoriteBoxes:function(e){return ne.apply(this,arguments)},isBoxFavorite:function(e,t){return ae.apply(this,arguments)}};function H(){return(H=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("auth/login",t);case 2:return n=e.sent,e.abrupt("return",Y(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("auth/logout");case 2:t=V(),sessionStorage.setItem("loggedinUser",JSON.stringify(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("auth/signup",t);case 2:return n=e.sent,e.abrupt("return",Y(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){var e=JSON.parse(sessionStorage.getItem("loggedinUser"));return e||(e=V(),sessionStorage.setItem("loggedinUser",JSON.stringify(e))),e}function V(){return{username:"Guest",fullName:"New Guest",imgUrl:"",isGuest:!0,_id:J()}}function J(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<e;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function Y(e){return sessionStorage.setItem("loggedinUser",JSON.stringify(e)),e}function K(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v("user/".concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return(Z=Object(f.a)(d.a.mark((function e(t){var n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=q()).isGuest){e.next=3;break}return e.abrupt("return");case 3:return a=n._id,e.next=6,K(a);case 6:return(r=e.sent).boxes||(r.boxes=[]),r.boxes.push(t),e.next=11,E("user/".concat(n._id),r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(f.a)(d.a.mark((function e(t){var n,a,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=q(),a=n._id,e.next=4,K(a);case 4:return r=e.sent,o=r.boxes.filter((function(e){return t!==e})),r.boxes=o,e.next=9,E("user/".concat(n._id),r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return(ee=Object(f.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:if((n=e.sent).boxes){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Promise.all(n.boxes.map(function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getById(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=Object(f.a)(d.a.mark((function e(t){var n,a,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=q()).isGuest){e.next=3;break}return e.abrupt("return");case 3:return a=n._id,e.next=6,K(a);case 6:if((r=e.sent).favoriteBoxes){e.next=12;break}r.favoriteBoxes=[],r.favoriteBoxes.push(t),e.next=16;break;case 12:return e.next=14,r.favoriteBoxes.findIndex((function(e){return e===t}));case 14:-1===(o=e.sent)?r.favoriteBoxes.push(t):r.favoriteBoxes.splice(o,1);case 16:return e.next=18,E("user/".concat(n._id),r);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(){return(ne=Object(f.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:if((n=e.sent).favoriteBoxes){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Promise.all(n.favoriteBoxes.map(function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getById(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(){return(ae=Object(f.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isGuest){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,K(t._id);case 4:if(a=e.sent,-1,a.favoriteBoxes){e.next=8;break}return e.abrupt("return",!1);case 8:return e.next=10,a.favoriteBoxes.findIndex((function(e){return e===n}));case 10:if(-1!==e.sent){e.next=13;break}return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re={users:[],loggedinUser:W.getUser()};var oe={boxes:null,currBox:null,currSong:null,filter:"",activeBoxes:null};var se={msgs:[],emojis:[]};var ce={connectedUsers:[]};var ie,le=Object(i.c)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return Object(p.a)(Object(p.a)({},e),{},{users:t.users});case"SET_USER":return Object(p.a)(Object(p.a)({},e),{},{loggedinUser:t.user});case"ADD_USER":return Object(p.a)(Object(p.a)({},e),{},{users:[].concat(Object(u.a)(e.users),[t.user]),loggedinUser:t.user});case"UPDATE_USER":return Object(p.a)(Object(p.a)({},e),{},{users:e.users.map((function(e){return t.user._id===e._id?t.user:e}))});default:return e}},boxReducer:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"SET_BOXES":return Object(p.a)(Object(p.a)({},t),{},{boxes:n.boxes});case"SET_CURR_BOX":return Object(p.a)(Object(p.a)({},t),{},{currBox:n.currBox});case"UPDATE_BOX":return Object(p.a)(Object(p.a)({},t),{},{currBox:n.currBox,boxes:null===(e=t.boxes)||void 0===e?void 0:e.map((function(e){return n.currBox._id===e._id?n.currBox:e}))});case"ADD_BOX":return Object(p.a)(Object(p.a)({},t),{},{boxes:[].concat(Object(u.a)(t.boxes),[n.box])});case"REMOVE_BOX":return Object(p.a)(Object(p.a)({},t),{},{boxes:t.boxes.filter((function(e){return e._id!==n.boxId}))});case"SET_ACTIVE_BOXES":return Object(p.a)(Object(p.a)({},t),{},{activeBoxes:n.boxes});case"SET_CURR_SONG":return Object(p.a)(Object(p.a)({},t),{},{currSong:n.currSong});case"SET_FILTER":return Object(p.a)(Object(p.a)({},t),{},{filter:n.filter});default:return t}},msgReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MSGS":return Object(p.a)(Object(p.a)({},e),{},{msgs:t.msgs});case"ADD_MSG":return Object(p.a)(Object(p.a)({},e),{},{msgs:[].concat(Object(u.a)(e.msgs),[t.msg])});default:return e}},connectedUsersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECTED_USERS":return Object(p.a)(Object(p.a)({},e),{},{connectedUsers:t.connectedUsers});default:return e}}}),ue=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,pe=Object(i.e)(le,ue(Object(i.a)(l.a))),me=n(24),de=n(8),fe=n(9),ge=n(11),he=n(10),be=n(23),ve=n(44),xe=n(84),Ee=n.n(xe),ye=n(83),Se=n.n(ye),Oe=n(162),we=n.n(Oe),je=n(158),ke=n.n(je),Ne=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){return Object(de.a)(this,n),t.apply(this,arguments)}return Object(fe.a)(n,[{key:"render",value:function(){var e=this.props,t=e.box,n=e.isHomePage,a=e.onDelete;return r.a.createElement("section",{className:"box-preview ".concat(n?"box-home-preview":"")},r.a.createElement(me.b,{to:"/box/details/".concat(t._id)},r.a.createElement("div",{className:"box-preview-img"}," ",r.a.createElement("img",{src:t.imgUrl,alt:"box-preview img"}))),r.a.createElement("div",{className:"box-preview-details flex column"},r.a.createElement("div",{className:"box-data flex space-between"},r.a.createElement("h3",{className:"box-name"},t.name),r.a.createElement(me.b,{to:"/box/details/".concat(t._id)},r.a.createElement(ke.a,null))),r.a.createElement("div",{className:"delete-btn",title:"Delete box"},a&&r.a.createElement(we.a,{onClick:function(e){return a(e,t._id)}}))))}}]),n}(a.Component),Ce=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={isScrolled:!1},e.ref=r.a.createRef(),e.executeScroll=function(t){var n=e.ref.current.scrollWidth-e.ref.current.offsetWidth;0!==e.ref.current.scrollLeft&&e.setState({isScrolled:!0}),e.ref.current.scrollLeft>=n?(e.ref.current.scrollLeft=0,e.setState({isScrolled:!1})):e.ref.current.scrollLeft<n?e.ref.current.scrollLeft+=t:e.setState({isScrolled:!1})},e}return Object(fe.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"list-container ".concat(this.props.genre?"":"main-container")},this.props.genre&&r.a.createElement("div",{className:"genre-filter flex align-enter space-between"},r.a.createElement("h3",{className:"title-genre"},this.props.genre),r.a.createElement(me.b,{to:"/box?&genre=".concat(this.props.genre)}," ",r.a.createElement("h3",{className:"see-all-genre"},"See All \u2192"))),this.props.genre&&r.a.createElement("div",{ref:this.ref,className:"box-list image-container ".concat("/"===this.props.location.pathname?"homepage-list":"")},this.state.isScrolled&&r.a.createElement("button",{className:"list-left-btn",onClick:function(){return e.executeScroll(-350)}},r.a.createElement(Se.a,null)),this.props.boxes.map((function(t){return t.genre===e.props.genre?r.a.createElement(Ne,{isHomePage:!0,key:t._id,box:t,genre:e.props.genre,onAddToFavorites:e.props.onAddToFavorites,minimalUser:e.props.minimalUser}):null})),r.a.createElement("button",{className:"list-right-btn",onClick:function(){return e.executeScroll(350)}},r.a.createElement(Ee.a,null))),!this.props.genre&&r.a.createElement("div",{className:"box-list full-grid "},this.props.boxes.map((function(t){return r.a.createElement(Ne,{isHomePage:!1,key:t._id,box:t,minimalUser:e.props.minimalUser,onAddToFavorites:e.props.onAddToFavorites,onDelete:e.props.onDelete})}))))}}]),n}(a.Component),Be=Object(be.f)(Ce),Ue=n(163),Re=n.n(Ue),De={setup:function(){ie=Re()("/")},terminate:function(){ie=null},on:function(e,t){ie.on(e,t)},off:function(e,t){ie.off(e,t)},emit:function(e,t){ie.emit(e,t)}};function Ie(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.query(e);case 2:a=t.sent,n({type:"SET_BOXES",boxes:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function Me(e){return function(t){t({type:"UPDATE_BOX",currBox:e})}}var Te=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={userBoxes:[],userBoxesFavorite:[]},e.onDelete=function(){var t=Object(f.a)(d.a.mark((function t(n,a){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.stopPropagation(),e.props.removeBox(a),t.next=4,W.removeBoxFromUser(a);case 4:return t.next=6,W.getUserBoxes(e.props.user._id);case 6:r=t.sent,e.setState({userBoxes:r});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.getUserBoxes(this.props.user._id);case 2:return t=e.sent,e.next=5,W.getUserFavoriteBoxes(this.props.user._id);case 5:n=e.sent,this.setState({userBoxes:t,userBoxesFavorite:n});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.user;if(this.props.user.isGuest&&this.props.history.push("/"),!e)return r.a.createElement(ve.CircleLoading,{size:"large",color:"#ac0aff"});var t=this.state,n=t.userBoxes,a=t.userBoxesFavorite,o=W.getMinimalUser();return r.a.createElement("div",{className:"user-details"},r.a.createElement("div",{className:"user-info"},r.a.createElement("img",{className:"img-user",src:e.imgUrl,alt:"user"}),r.a.createElement("h2",null,e.username),r.a.createElement("h2",null,e.fullName)),n&&r.a.createElement("div",{className:"user-boxes"},r.a.createElement("h2",null,"Boxes I created: "),r.a.createElement(Be,{boxes:n,minimalUser:o,connectedUsers:this.props.connectedUsers,onDelete:this.onDelete})),a&&r.a.createElement("div",{className:"user-boxes-favorite"},r.a.createElement("h2",null,"My Favorite Boxes: "),r.a.createElement(Be,{boxes:a,minimalUser:o,connectedUsers:this.props.connectedUsers})))}}]),n}(a.Component),_e={removeBox:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.remove(e);case 2:n({type:"REMOVE_BOX",boxId:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Pe=Object(c.b)((function(e){return{user:e.userReducer.loggedinUser,connectedUsers:e.connectedUsersReducer.connectedUsers}}),_e)(Te),Ae=n(48),Fe=n(38),Le=n.n(Fe),Ge=n(164),We=n(429),He=n(169),Xe=n.n(He),ze=n(170),qe=n.n(ze),Ve=n(172),Je=n.n(Ve),Ye=n(171),Ke=n.n(Ye),Qe=n(173),Ze=n.n(Qe),$e=n(165),et=n(166),tt=n(42),nt=n(441),at=n(167),rt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={searchStr:"",results:"",isSearching:!1},e.inputRef=r.a.createRef(),e.nullResults=function(){e.setState({searchStr:"",results:"",isSearching:!1})},e.handleInput=function(t){var n=t.target.value;n?(e.setState({results:"",searchStr:n,isSearching:!0}),e.debouncedSearch||(e.debouncedSearch=Object(at.debounce)((function(){return e.getSongs()}),1e3)),e.debouncedSearch()):e.nullResults()},e.getSongs=Object(f.a)(d.a.mark((function t(){var n,a,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.searchStr,t.next=3,B.get(n);case 3:if(a=t.sent){t.next=6;break}return t.abrupt("return");case 6:r=a.items,e.setState({results:r});case 8:case"end":return t.stop()}}),t)}))),e.onAddSong=function(t){e.props.onAddSong(t)},e}return Object(fe.a)(n,[{key:"componentDidUpdate",value:function(e){e.isSongPickOpen!==this.props.isSongPickOpen&&this.nullResults(),!e.isSongPickOpen&&this.props.isSongPickOpen&&this.inputRef.current.focus()}},{key:"render",value:function(){var e=this,t=this.state,n=t.results,a=t.isSearching,o=t.searchStr,s=this.props.isFilter;return r.a.createElement("div",{className:"song-pick ".concat(this.props.isSongPickOpen?"opened":"")},r.a.createElement("input",{ref:this.inputRef,type:"search",name:"searchStr",value:o,onChange:this.handleInput,placeholder:"Search for music",autoComplete:"off"}),r.a.createElement("div",{className:"song-pick-msg flex justify-center ".concat(n.length?"hidden":"")},a&&!n&&r.a.createElement(r.a.Fragment,null,"Getting results...",r.a.createElement(ve.CircleLoading,{color:"#ac0aff"})),n&&!n.length&&"No results found."),n&&n.map((function(t,n){var a=t.id.videoId,o=B.titleSimplify(t.snippet.title),c=t.snippet.thumbnails.medium.url;return r.a.createElement(tt.b,{key:a,draggableId:a,index:n,isDragDisabled:s},(function(n){return r.a.createElement("div",Object.assign({ref:n.innerRef},n.draggableProps,n.dragHandleProps,{className:"song-pick-result flex",onClick:function(){return e.onAddSong(t)}}),r.a.createElement("img",{src:c,alt:"thumbnail"}),r.a.createElement("h3",{dir:"auto"},o))}))})))}}]),n}(a.Component),ot=n(168),st=n.n(ot),ct=n(85),it=n.n(ct),lt=n(56),ut=n.n(lt),pt=n(55),mt=n.n(pt);function dt(e){return function(t){t({type:"SET_CURR_SONG",currSong:e})}}function ft(e){return function(t){e=Object(p.a)(Object(p.a)({},e),{},{isPlaying:!e.isPlaying}),De.emit("set currSong",e),t({type:"SET_CURR_SONG",currSong:e})}}function gt(e){return function(t){var n={id:e,isPlaying:!0,secPlayed:0};De.emit("set currSong",n),t({type:"SET_CURR_SONG",currSong:n})}}var ht=function(e){Object(ge.a)(a,e);var t=Object(he.a)(a);function a(){var e;Object(de.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isRemoveOpen:!1,timeoutId:null},e.toggleRemoveOpen=function(t){t.stopPropagation();var n=setTimeout((function(){return e.setState({isRemoveOpen:!1})}),2e3);e.setState((function(e){return{isRemoveOpen:!e.isRemoveOpen,timeoutId:n}}))},e.remove=function(t,n){clearTimeout(e.state.timeoutId),t.stopPropagation(),e.props.onRemoveSong(n)},e}return Object(fe.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.currSong,o=t.songDetails,s=t.index,c=t.isFilter,i=t.togglePlay,l=this.state.isRemoveOpen,u=o.id===(null===a||void 0===a?void 0:a.id)&&(null===a||void 0===a?void 0:a.isPlaying);return r.a.createElement(tt.b,{draggableId:o.id,index:s,isDragDisabled:c},(function(t){return r.a.createElement("li",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:"song-preview flex space-between",onDoubleClick:function(){return e.props.changeSong(o.id)}}),r.a.createElement("div",{className:"song-data flex align-center"},r.a.createElement("div",{className:"play-icon-container flex align-center cursor-pointer"},u?r.a.createElement(mt.a,{onClick:function(){return i(a)},className:"play-icon ".concat(u?"now-playing":"")}):r.a.createElement(ut.a,{onClick:function(){return e.props.changeSong(o.id)},className:"play-icon"})),r.a.createElement("div",{className:"song-preview-img"},r.a.createElement("img",{src:o.imgUrl,alt:"song-img"})),r.a.createElement("h3",{className:u?"now-playing":""},o.title)),r.a.createElement("div",{className:"song-preview-btns flex align-center"},r.a.createElement("h3",{className:"song-duration"},o.duration||""),r.a.createElement("img",{className:"playing-anim ".concat(u?"":"invisible"),src:n(136),title:"Now playing",alt:"now-playing"}),l?r.a.createElement("div",{onClick:function(t){return e.remove(t,o.id)},className:"remove-song-btn ".concat(l?"":"invisible")},r.a.createElement(st.a,null)):r.a.createElement("div",null,r.a.createElement(it.a,{className:"cursor-pointer",onClick:e.toggleRemoveOpen}))))}))}}]),a}(a.Component),bt={togglePlay:ft,changeSong:gt},vt=Object(c.b)((function(e){return{currSong:e.boxReducer.currSong}}),bt)(ht);function xt(e){var t=e.isFirst,a=parseInt(40*Math.random()+40);return r.a.createElement("li",{key:t?1:2,className:"song-preview flex space-between"},r.a.createElement("div",{className:"song-data flex align-center"},r.a.createElement("div",{className:"play-icon-container flex align-center"},t?r.a.createElement(mt.a,{className:"play-icon now-playing"}):r.a.createElement(ut.a,{className:"play-icon"})),r.a.createElement("div",{className:"song-preview-img"},r.a.createElement("img",{src:"https://picsum.photos/id/".concat(a,"/120/90"),alt:"song-img"})),r.a.createElement("h3",{className:t?"now-playing":""},t?"Your songs go here... Click '+' to add them":"This could be your song")),r.a.createElement("div",{className:"song-preview-btns flex align-center"},r.a.createElement("h3",{className:"song-duration"},t?"3:22":"4:15"),r.a.createElement("img",{className:"playing-anim ".concat(t?"":"invisible"),src:n(136),title:"Now playing",alt:"now-playing"}),r.a.createElement("div",null,r.a.createElement(it.a,null))))}function Et(e){var t=e.songs,n=e.onRemoveSong,a=e.onAddSong,o=e.isSongPickOpen,s=e.isFilter,c=e.isDragging,i=e.onDragEnd,l=e.onDragStart;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.a,{onDragStart:l,onDragEnd:i},r.a.createElement("div",{className:"song-list flex space-between"},r.a.createElement(tt.c,{droppableId:"songPick"},(function(e){return r.a.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef,className:"song-pick-container ".concat(o&&"opened")}),r.a.createElement(rt,{isSongPickOpen:o,onAddSong:a}),e.placeholder)})),r.a.createElement(tt.c,{droppableId:"songList"},(function(e){return r.a.createElement("ul",Object.assign({},e.droppableProps,{ref:e.innerRef,className:"clean-list flex column flex-1"}),!t.length&&!s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(xt,{key:1,isFirst:!0}),r.a.createElement(xt,{key:2,isFirst:!1})),!t.length&&s&&r.a.createElement("li",null,"No search results..."),t.map((function(e,t){return r.a.createElement(vt,{key:e.id,index:t,onRemoveSong:n,songDetails:e,isFilter:s})})),e.placeholder)}))),r.a.createElement(tt.c,{droppableId:"trash"},(function(e){return r.a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps,{className:"remove-song-drag flex ".concat(c?"opened":"")}),r.a.createElement(nt.a,{className:"bin"}))}))))}var yt=n(33),St=n(109),Ot=n.n(St),wt=n(110),jt=n.n(wt),kt=n(397),Nt={uploadImg:function(e){return Ct.apply(this,arguments)},makeFaceThumb:function(e){var t=e.split("/");return t.splice(6,0,"w_200,h_200,c_thumb,g_face"),t=t.join("/")}};function Ct(){return(Ct=Object(f.a)(d.a.mark((function e(t){var n,a,r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"dawzeno7k",n="https://api.cloudinary.com/v1_1/".concat("dawzeno7k","/image/upload"),(a=new FormData).append("file",t.target.files[0]),a.append("upload_preset","beatboximg"),e.prev=5,e.next=8,fetch(n,{method:"POST",body:a});case 8:return r=e.sent,e.next=11,r.json();case 11:return o=e.sent,e.abrupt("return",o.secure_url);case 15:e.prev=15,e.t0=e.catch(5),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,15]])})))).apply(this,arguments)}var Bt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={box:null,isEditableName:!1,isEditableDesc:!1,isEditableImg:!1},e.onEdit=function(t){e.setState(Object(yt.a)({},t,!0))},e.onSave=function(t){e.setState(Object(yt.a)({},t,!1));var n=Object(p.a)({},e.state.box);e.props.onSaveInfo(n)},e.handleInput=function(t){var n=t.target,a=n.name,r=n.value;e.setState((function(e){return{box:Object(p.a)(Object(p.a)({},e.box),{},Object(yt.a)({},a,r))}}))},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.box;this.setState({box:e})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.box;e.box!==n&&this.setState({box:n})}},{key:"uploadImg",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.uploadImg(t);case 2:n=e.sent,this.setState((function(e){return{box:Object(p.a)(Object(p.a)({},e.box),{},{imgUrl:n})}})),this.onSave("isEditableImg");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.box,a=t.isEditableName,o=t.isEditableDesc;return n?r.a.createElement("section",{className:"box-info flex"},r.a.createElement("div",{className:"box-img"},r.a.createElement("label",{className:"upload-label",style:{cursor:"pointer"}},r.a.createElement("input",{onChange:function(t){return e.uploadImg(t)},type:"file",hidden:!0}),r.a.createElement("img",{crossOrigin:"anonymous",ref:this.props.imgRef,src:n.imgUrl,alt:"",onLoad:this.props.getDominantColor}))),r.a.createElement("div",{className:"info-txt flex space-between column"},r.a.createElement("div",{className:"info-header flex align-end flex-1"},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{autoFocus:!0,type:"txt",value:n.name,name:"name",onChange:this.handleInput}),r.a.createElement("div",{className:"btn-hide-container"},r.a.createElement("button",{className:"save-btn",onClick:function(){return e.onSave("isEditableName")}},r.a.createElement(Ot.a,null)))):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"box-name"}," ",n.name),r.a.createElement("button",{onClick:function(){return e.onEdit("isEditableName")},className:"hide-btn"},r.a.createElement(jt.a,null)))),r.a.createElement("div",{className:"info-description flex"},!o&&r.a.createElement("p",{className:"box-description"}," ",n.description),r.a.createElement("div",{className:"btn-hide-container"},!o&&r.a.createElement("button",{onClick:function(){return e.onEdit("isEditableDesc")},className:"hide-btn"},r.a.createElement(jt.a,null))),o&&r.a.createElement("textarea",{autoFocus:!0,type:"txt",value:n.description,name:"description",onChange:this.handleInput}),o&&r.a.createElement("button",{className:"save-btn",onClick:function(){return e.onSave("isEditableDesc")}},r.a.createElement(Ot.a,null))),r.a.createElement("h4",null,n.genre),r.a.createElement("div",{className:"info-creator flex align-center"},r.a.createElement("h5",null,"Created By: "),r.a.createElement(kt.a,{alt:"Remy Sharp",src:n.createdBy.imgUrl,style:{width:"35px",height:"35px"}}),r.a.createElement("h5",null,n.createdBy.name)))):r.a.createElement(Le.a,{size:"large",color:"#ac0aff"})}}]),n}(a.Component),Ut=n(57),Rt=n(428);n(381);function Dt(e){return function(t){t({type:"SET_MSGS",msgs:e})}}function It(e){return function(t){t({type:"ADD_MSG",msg:e})}}var Mt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={msgs:[],msg:"",isTyping:!1,typingStr:""},e.inputRef=r.a.createRef(),e.chatRef=r.a.createRef(),e.scrollToBottom=function(){e.chatRef.current.scrollIntoView({behavior:"smooth"})},e.onTyping=function(t){e.setState({typingStr:t})},e.onHandleChange=function(){var t=Object(f.a)(d.a.mark((function t(n){var a,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.target.value){t.next=2;break}return t.abrupt("return");case 2:return e.state.isTyping?(clearTimeout(a),a=setTimeout(e.timeoutFunction,1500)):(clearTimeout(a),e.setState({isTyping:!0}),r=e.props.user.username,o=r+" is typing...",De.emit("chat typing",o),a=setTimeout(e.timeoutFunction,1500)),t.next=5,e.setState({msg:n.target.value});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.timeoutFunction=function(){e.setState({isTyping:!1}),De.emit("chat typing","")},e.sendMsg=function(t){var n=e.state.msg;if(n){var a={text:n,submitAt:new Date,id:e.props.user._id,submitBy:e.props.user.username,avatar:e.props.user.imgUrl};De.emit("chat newMsg",a)}e.setState({msg:""}),e.inputRef.clear()},e.onKeyUp=function(t){"Enter"===t.key&&e.sendMsg()},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){De.on("chat showTyping",this.onTyping)}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"componentWillUnmount",value:function(){De.off("chat showTyping",this.onTyping)}},{key:"getMsgsArr",value:function(){var e=this.props,t=e.msgs,n=e.user,a=[];return t.forEach((function(e,t){var o,s,c="";e.id===n._id?(s="you",o="user-message",c="flex-end"):(s=e.submitBy,o="not-user-message");var i=new Date(e.submitAt),l="".concat(i.getHours(),":").concat(i.getMinutes().toString().padStart(2,"0"));"system"===e.id?a.push(r.a.createElement(Ut.SystemMessage,{key:t,text:e.text})):a.push(r.a.createElement("div",{key:t,className:"msg flex column ".concat(c)},r.a.createElement("div",{className:"msg-data flex align-center"},!c&&r.a.createElement(kt.a,{title:n.fullName,alt:"User",src:e.avatar,style:{width:"20px",height:"20px"}}),r.a.createElement("p",{className:"submit-by"},s),l),r.a.createElement("div",{className:"msg-text ".concat(o)},e.text)))})),a}},{key:"getConnectedAvatars",value:function(){return this.props.connectedUsers.map((function(e){return r.a.createElement(kt.a,{key:e.id,alt:e.username,src:e.imgUrl})}))}},{key:"render",value:function(){var e=this,t=this.state.typingStr,n=this.getConnectedAvatars();return r.a.createElement("section",{className:"wall-container flex column space-between"},r.a.createElement("h2",{className:"chat-title"}," Box Wall "),r.a.createElement("div",{className:"connected-users flex justify-center"},r.a.createElement(Rt.a,{max:4},n)),r.a.createElement("div",{className:"msgs"},this.getMsgsArr(),r.a.createElement("div",{className:"typing-container"},t&&r.a.createElement("h3",null,t)),r.a.createElement("div",{ref:this.chatRef})),r.a.createElement("div",{className:"input-msg"},r.a.createElement(Ut.Input,{ref:function(t){return e.inputRef=t},onChange:this.onHandleChange,placeholder:"Type here...",onKeyUp:this.onKeyUp,rightButtons:r.a.createElement(Ut.Button,{className:"btn-send",text:"Send",onClick:this.sendMsg,backgroundColor:"#18191a"})})))}}]),n}(a.Component),Tt={loadMsgs:Dt,addMsg:It},_t=Object(c.b)((function(e){return{user:e.userReducer.loggedinUser,msgs:e.msgReducer.msgs,box:e.boxReducer.currBox,connectedUsers:e.connectedUsersReducer.connectedUsers}}),Tt)(Mt);function Pt(e){return function(t){t({type:"SET_CONNECTED_USERS",connectedUsers:e})}}var At=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={isSongPickOpen:!1,isDragging:!1,msgs:[],dominantColor:"",isMobileChatOpen:!1,isClipboardToast:!1,isFavorite:!1,isGuestMode:!1},e.imgRef=r.a.createRef(),e.onRemoveSong=function(t){var n=e.props.currSong,a=Object(p.a)({},e.props.currBox),r=a.songs.findIndex((function(e){return e.id===t}));if(!n||n.id===t)if(1===a.songs.length)e.props.updateLocalPlayer(null);else if(n&&n.isPlaying){var o=r+1;o===a.songs.length&&(o=0),e.props.changeSong(a.songs[o].id)}var s=a.songs.splice(r,1),c=Object(Ae.a)(s,1)[0];e.addMsgChat("Song ".concat(c.title," removed by ").concat(e.props.user.username)),e.props.updateBox(a)},e.onAddSong=function(){var t=Object(f.a)(d.a.mark((function t(n,a,r){var o,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.addSong(n,r);case 2:o=t.sent,s=Object(p.a)({},e.props.currBox),a?s.songs.splice(a,0,o):s.songs.unshift(o),e.addMsgChat("Song ".concat(o.title," added by ").concat(e.props.user.username)),e.props.updateBox(s);case 7:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),e.onSaveInfo=function(t){e.props.updateBox(t)},e.getSongsForDisplay=function(){return e.props.currBox.songs.filter((function(t){return t.title.toLowerCase().includes(e.props.filter.toLowerCase())}))},e.toggleSongPick=function(){e.setState((function(e){return{isSongPickOpen:!e.isSongPickOpen}}))},e.onDragStart=function(){e.setState({isDragging:!0})},e.onDragEnd=function(){var t=Object(f.a)(d.a.mark((function t(n){var a,r,o,s,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.destination,r=n.source,o=n.draggableId,e.setState({isDragging:!1}),a){t.next=4;break}return t.abrupt("return");case 4:if("songPick"!==a.droppableId){t.next=6;break}return t.abrupt("return");case 6:if("songList"!==r.droppableId||"trash"!==a.droppableId){t.next=9;break}return e.onRemoveSong(o),t.abrupt("return");case 9:if("songPick"!==r.droppableId||"songList"!==a.droppableId){t.next=17;break}return t.next=12,B.getSongById(o);case 12:return s=t.sent,c=Object(Ae.a)(s.items,1),s=c[0],e.onAddSong(s,a.index,!0),t.abrupt("return");case 17:if(a.index!==r.index){t.next=21;break}return t.abrupt("return");case 21:e.onSwapSongs(r.index,a.index);case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.addMsgChat=function(t){var n={text:t,id:"system",submitBy:"system",avatar:e.props.user.imgUrl};De.emit("chat newMsg",n)},e.onSwapSongs=function(t,n){var a=Object(u.a)(e.props.currBox.songs),r=a.splice(t,1),o=Object(Ae.a)(r,1)[0];a.splice(n,0,o);var s=Object(p.a)(Object(p.a)({},e.props.currBox),{},{songs:a});e.props.updateBox(s)},e.getDominantColor=function(){var t=new $e.a,n=e.imgRef.current,a=t.getColor(n,50);a.every((function(e){return e>180}))&&(a=a.map((function(e){return e>150?150:e}))),e.setState({dominantColor:a})},e.toggleClipboardToast=function(){e.setState({isClipboardToast:!0}),setTimeout((function(){return e.setState({isClipboardToast:!1})}),2e3)},e.toggleGuestMode=function(){e.setState({isGuestMode:!0}),setTimeout((function(){return e.setState({isGuestMode:!1})}),2e3)},e.openMobileChat=function(){e.setState({isMobileChatOpen:!0})},e.closeMobileChat=function(){e.setState({isMobileChatOpen:!1})},e.toggleMobileChat=function(){e.setState({isMobileChatOpen:!e.state.isMobileChatOpen})},e.onToggleToFavorite=Object(f.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.props.user.isGuest){t.next=3;break}return e.toggleGuestMode(),t.abrupt("return");case 3:return n=e.props.currBox._id,t.next=6,W.toggleToFavorite(n);case 6:e.setState({isFavorite:!e.state.isFavorite});case 7:case"end":return t.stop()}}),t)}))),e.getIfBoxFavorite=Object(f.a)(d.a.mark((function t(){var n,a,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.currBox._id,a=e.props.user._id,t.next=4,W.isBoxFavorite(a,n);case 4:return r=t.sent,o=-1===r,t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)}))),e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.boxId,n=W.getMinimalUser(),e.next=4,this.props.loadBox(t);case 4:return e.next=6,W.isBoxFavorite(this.props.user,t);case 6:a=e.sent,this.setState({isFavorite:a}),r={boxId:t,user:n},De.emit("join box",r);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){this.props.match.params.boxId!==this.props.currBox._id&&this.props.loadBox(this.props.match.params.boxId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isSongPickOpen,a=t.isDragging,o=t.isFavorite,s=this.props,c=s.currBox,i=s.filter;if(!c)return r.a.createElement(Le.a,{size:"large",color:"#ac0aff"});var l=this.getSongsForDisplay(),u=W.getMinimalUser(),p={onSwipedRight:function(){return e.openMobileChat()},onSwipedLeft:function(){return e.closeMobileChat()},preventDefaultTouchmoveEvent:!0,trackMouse:!0};return r.a.createElement(et.a,p,r.a.createElement("section",{className:"box-details",style:{backgroundColor:"rgb(".concat(this.state.dominantColor,")")}},r.a.createElement("div",{className:"box-details-main flex column"},r.a.createElement(Bt,{getDominantColor:this.getDominantColor,imgRef:this.imgRef,box:c,onSaveInfo:this.onSaveInfo,minimalUser:u}),r.a.createElement("div",{className:"song-social-actions flex space-between"},r.a.createElement("div",{className:"btns-container flex align-center"},r.a.createElement(We.a,{className:"add-song-btn  ".concat(n?"opened":""),onClick:this.toggleSongPick,"aria-label":"add"},r.a.createElement(Xe.a,null)),r.a.createElement("div",{title:"Add to favorite",className:"like-btn flex align-center ".concat(o?"favorite":"")},r.a.createElement(qe.a,{onClick:this.onToggleToFavorite}),this.state.isGuestMode&&r.a.createElement("div",{className:"guest-msg"},r.a.createElement("small",null,"Signup to enjoy favorite feature")))),r.a.createElement("div",{className:"share-container flex space-between column"},r.a.createElement("p",null,"Invite a friend to join you:"),r.a.createElement("div",{className:"share-btns flex space-evenely"},r.a.createElement("a",{className:"facebook-share-btn",href:"https://www.facebook.com/sharer/sharer.php?u=".concat(window.location.href),rel:"noopener noreferrer",target:"_blank"},r.a.createElement(Ke.a,null)),r.a.createElement("a",{className:"whatsapp-share-btn",href:"whatsapp://send?text=".concat(c.createdBy.name," Shared a Box With You! : \n\n ").concat(window.location.href),"data-action":"share/whatsapp/share"},r.a.createElement(Je.a,null)),r.a.createElement(Ge.CopyToClipboard,{className:"copy-share-btn",text:window.location.href},r.a.createElement(Ze.a,{onClick:this.toggleClipboardToast,style:{transform:"rotate(45deg) translateY(1px) translateX(4px)"}}))),this.state.isClipboardToast&&r.a.createElement("div",{className:"copied-to-clipboard"},r.a.createElement("small",null,"Link copied to your clipboard!")))),r.a.createElement(Et,{songs:l,onRemoveSong:this.onRemoveSong,onAddSong:this.onAddSong,isSongPickOpen:n,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,isFilter:!!i,isDragging:a})),r.a.createElement("div",{className:"".concat(this.state.isMobileChatOpen?"chat-open":""," chat-box flex column align-center")},r.a.createElement(_t,null))))}}]),n}(a.Component),Ft={loadBox:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.getById(e);case 2:a=t.sent,n({type:"SET_CURR_BOX",currBox:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},updateBox:function(e){return function(t){M.update(e),De.emit("set currBox",e),t({type:"UPDATE_BOX",currBox:e})}},addMsg:It,loadMsgs:Dt,updateLocalPlayer:dt,gotBoxUpdate:Me,loadConnectedUsers:Pt,changeSong:gt},Lt=Object(c.b)((function(e){return{currBox:e.boxReducer.currBox,currSong:e.boxReducer.currSong,filter:e.boxReducer.filter,user:e.userReducer.loggedinUser,msgs:e.msgReducer.msgs,connectedUsers:e.connectedUsersReducer.connectedUsers}}),Ft)(At),Gt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={genres:[],isScrolled:!1},e.executeScroll=function(t){var n=e.ref.current.scrollWidth-e.ref.current.offsetWidth;0!==e.ref.current.scrollLeft&&e.setState({isScrolled:!0}),e.ref.current.scrollLeft>=n?(e.ref.current.scrollLeft=0,e.setState({isScrolled:!1})):e.ref.current.scrollLeft<n?e.ref.current.scrollLeft+=t:e.setState({isScrolled:!1})},e.getQueryParams=function(t){var n=new URLSearchParams(e.props.history.location.search);return n.set("genre",t),n.toString()},e.getCurrGenre=function(){return new URLSearchParams(e.props.history.location.search).get("genre")},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){this.ref=r.a.createRef();var e=M.getAllGenres();this.setState({genres:Object(u.a)(e)})}},{key:"render",value:function(){var e=this,t=this.state.genres;if(!t.length)return r.a.createElement("h1",null,"Loading...");var n=this.getCurrGenre(),a=!!this.props.location.search;return r.a.createElement("div",{className:"main-container"},r.a.createElement("div",{className:"btns-filter",ref:this.ref},this.state.isScrolled&&r.a.createElement("button",{className:"list-left-btn",onClick:function(){return e.executeScroll(-100)}},r.a.createElement(Se.a,null)),r.a.createElement(me.b,{to:"/box",className:"btn-filter flex justify-center align-center".concat(a?"":"active-filter")},"All"),t.map((function(t,a){return r.a.createElement(me.b,{to:"/box?".concat(e.getQueryParams(t)),className:"btn-filter ".concat(t===n?"active-filter":""),key:a}," ",t)})),r.a.createElement("button",{className:"list-right-btn",onClick:function(){return e.executeScroll(100)}},r.a.createElement(Ee.a,null))))}}]),n}(a.Component),Wt=Object(be.f)(Gt),Ht=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onLoadBoxes=function(){e.props.loadBoxes(e.props.location.search)},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){this.onLoadBoxes()}},{key:"componentDidUpdate",value:function(e){this.props.location.search!==e.location.search&&this.onLoadBoxes()}},{key:"render",value:function(){var e=this.props,t=e.boxes,n=e.genres,a=W.getMinimalUser();return t?r.a.createElement("section",{className:"box-app",id:"box"},!!n&&n.map((function(e,n){return r.a.createElement(Be,{boxes:t,key:n,genre:e,minimalUser:a})})),!n&&r.a.createElement(Wt,{genreCount:5}),!n&&r.a.createElement(Be,{boxes:t,minimalUser:a})):r.a.createElement(Le.a,{size:"large",color:"#ac0aff"})}}]),n}(a.Component),Xt={loadBoxes:Ie},zt=Object(c.b)((function(e){return{boxes:e.boxReducer.boxes,user:e.userReducer.loggedinUser}}),Xt)(Object(be.f)(Ht)),qt=n(86),Vt=n.n(qt),Jt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={box:{name:"",genre:"",description:"",imgUrl:null}},e.onSaveInfo=function(t){t.preventDefault(),e.props.onSaveInfo(e.state.box)},e.handleInput=function(t){var n=t.target,a=n.name,r=n.value;e.setState((function(e){return{box:Object(p.a)(Object(p.a)({},e.box),{},Object(yt.a)({},a,r))}}),(function(){return e.props.updateBox(e.state.box)}))},e}return Object(fe.a)(n,[{key:"getGenresOptions",value:function(){return M.getAllGenres().map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))}},{key:"uploadImg",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,a=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.setIsLoading(!0),e.next=3,Nt.uploadImg(t);case 3:n=e.sent,this.props.setIsLoading(!1),this.setState((function(e){return{box:Object(p.a)(Object(p.a)({},e.box),{},{imgUrl:n})}}),(function(){return a.props.updateBox(a.state.box)}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.box;return t?r.a.createElement("form",null,r.a.createElement("div",{className:"box-add-form flex column"},r.a.createElement("div",{className:"box-add-thumbnail flex"},r.a.createElement("label",{className:"upload-label",style:{cursor:"pointer"}},r.a.createElement("input",{onChange:function(t){return e.uploadImg(t)},type:"file",hidden:!0}),r.a.createElement("img",{src:t.imgUrl||Vt.a,alt:"box"}),r.a.createElement("div",null,t.imgUrl?"":"Upload Image"))),r.a.createElement("div",{className:"inputs flex column align-center"},r.a.createElement("label",null,"Name:"),r.a.createElement("input",{className:"short-input",autoComplete:"off",autoFocus:!0,type:"txt",value:t.name,name:"name",onChange:this.handleInput,placeholder:"Box Name"}),r.a.createElement("label",null,"Genre:"),r.a.createElement("select",{className:"short-input",id:"genre",name:"genre",onChange:this.handleInput},r.a.createElement("option",{disabled:!0,selected:!0,value:""},"Select genre"),this.getGenresOptions()),r.a.createElement("label",null,"Description:"),r.a.createElement("textarea",{type:"txt",value:t.description,name:"description",onChange:this.handleInput,placeholder:"About the box"})))):r.a.createElement(Le.a,{size:"large",color:"#ac0aff"})}}]),n}(a.Component),Yt=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={editBox:null,msgWarning:"",isLoading:!1},e.setNewBox=function(){var t=W.getMinimalUser(),n=M.getEmptyBox(t);e.setState({editBox:n})},e.setIsLoading=function(t){e.setState({isLoading:t})},e.updateBox=function(t){e.setState((function(e){return{editBox:Object(p.a)(Object(p.a)({},e.editBox),{},{name:t.name,genre:t.genre,description:t.description,imgUrl:t.imgUrl})}}))},e.onAddBox=function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),n.stopPropagation(),e.state.editBox.name){t.next=5;break}return e.printMsg("Name of box is required"),t.abrupt("return");case 5:if(e.state.editBox.genre){t.next=8;break}return e.printMsg("Genre of box is required"),t.abrupt("return");case 8:return t.next=10,e.props.saveBox(e.state.editBox);case 10:a=t.sent,e.props.loadBoxes(),e.props.history.push("/box/details/".concat(a._id));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.closeModal=function(){e.props.history.goBack(),e.setNewBox()},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){this.setNewBox()}},{key:"printMsg",value:function(e){var t=this;this.setState({msgWarning:e}),setTimeout((function(){t.setState({msgWarning:""})}),2e3)}},{key:"render",value:function(){return this.state.editBox?r.a.createElement("section",{onClick:this.closeModal,className:"box-add-container flex justify-center"},r.a.createElement("div",{className:"box-add-modal flex column",onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"Create your own Box"),r.a.createElement(Jt,{updateBox:this.updateBox,setIsLoading:this.setIsLoading}),r.a.createElement("button",{disabled:this.state.isLoading,className:"btn-create ".concat(this.state.isLoading?"faded-btn":""),onClick:this.onAddBox},"Create Box"),this.state.msgWarning&&r.a.createElement("label",{className:"msg-warnning"},this.state.msgWarning))):r.a.createElement(Le.a,{size:"large",color:"#ac0aff"})}}]),n}(a.Component),Kt={saveBox:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.save(e);case 2:return a=t.sent,n({type:"ADD_BOX",box:a}),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},loadBoxes:Ie},Qt=Object(c.b)((function(e){return{}}),Kt)(Object(be.f)(Yt)),Zt=n(177),$t=n.n(Zt),en=n(89),tn=n.n(en),nn=n(90),an=n.n(nn),rn=n(174),on=n.n(rn),sn=n(175),cn=n.n(sn),ln=n(176),un=n.n(ln);function pn(){return r.a.createElement("footer",{className:"footer flex column align-center justify-center"},r.a.createElement("div",{className:"container flex justify-center"},r.a.createElement("div",{className:"developer flex align-center "},r.a.createElement("img",{alt:"Idan",src:on.a}),r.a.createElement("p",null,"Idan Benjamin"),r.a.createElement("a",{href:"https://www.linkedin.com/in/idanbenjamin"}," ",r.a.createElement(tn.a,null)),r.a.createElement("a",{href:"https://github.com/tzookyb"}," ",r.a.createElement(an.a,null))),r.a.createElement("div",{className:"developer flex align-center"},r.a.createElement("img",{alt:"Hilla",src:cn.a}),r.a.createElement("p",null,"Hilla Meri"),r.a.createElement("a",{href:"https://www.linkedin.com/in/hilla-meri-a9757a182"}," ",r.a.createElement(tn.a,null)),r.a.createElement("a",{href:"https://github.com/HillaMeri"}," ",r.a.createElement(an.a,null))),r.a.createElement("div",{className:"developer flex align-center"},r.a.createElement("img",{alt:"Matan",src:un.a}),r.a.createElement("p",null,"Matan Crispel"),r.a.createElement("a",{href:"https://www.linkedin.com/in/matan-crispel-7316aa1a9"}," ",r.a.createElement(tn.a,null)),r.a.createElement("a",{href:"https://github.com/matancris"}," ",r.a.createElement(an.a,null)))),r.a.createElement("small",null,"\xa9 Coffee Rights BeatBox 2020"))}var mn=function(e){Object(ge.a)(a,e);var t=Object(he.a)(a);function a(){return Object(de.a)(this,a),t.apply(this,arguments)}return Object(fe.a)(a,[{key:"componentDidMount",value:function(){this.props.loadBoxes(),setTimeout((function(){return De.emit("get active boxes")}),1),this.clientHeight=window.innerHeight}},{key:"render",value:function(){var e=this,t=this.props.boxes;if(!t)return r.a.createElement(ve.CircleLoading,{size:"large",color:"#ac0aff"});var a=M.getUsedGenres(t);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"top",className:"hero-container flex justify-center align-center"},r.a.createElement("div",{className:"hero-txt flex align-center justify-end column"},r.a.createElement("div",{className:"hero-title flex justify-end column"},r.a.createElement("h1",null,"Share the Beat"),r.a.createElement("p",null,"Enjoy music. Enjoy company.")),r.a.createElement("div",{className:"hero-btns-container flex column space-around"},r.a.createElement("button",{onClick:function(){return window.scrollTo(0,e.clientHeight)}},"Start listening"),r.a.createElement("a",{href:"#box",className:"scroll-down-arrow"},r.a.createElement($t.a,null)))),r.a.createElement("div",{className:"hero-img"},r.a.createElement("img",{src:n(382),alt:""}),r.a.createElement("img",{src:n(383),alt:""}),r.a.createElement("img",{src:n(384),alt:""}))),r.a.createElement("div",{className:"genre-list"},a.length&&r.a.createElement(zt,{genres:a})),r.a.createElement(pn,null))}}]),a}(a.Component),dn={loadBoxes:Ie},fn=Object(c.b)((function(e){return{boxes:e.boxReducer.boxes}}),dn)(mn),gn=n(181),hn=n.n(gn),bn=n(180),vn=n.n(bn),xn=n(178),En=n.n(xn),yn=n(430),Sn=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={searchStr:"",isSearchOpen:!1,isAtBoxDetails:!1},e.ref=r.a.createRef(),e.checkIfAtDetails=function(){var t=e.props.location.pathname.startsWith("/box/details");t!==e.state.isAtBoxDetails&&e.setState({searchStr:"",isAtBoxDetails:t})},e.onHandleChange=function(t){var n=t.target;e.setState({searchStr:n.value},e.onSetFilter),e.state.isSearchOpen&&(e.debouncedSearch||(e.debouncedSearch=Object(yn.a)((function(){e.state.isSearchOpen&&e.toggleSearch()}),3e3)),e.debouncedSearch())},e.onSetFilter=function(){if(e.state.isAtBoxDetails)e.props.setFilter(e.state.searchStr);else{var t=new URLSearchParams(window.location.search);e.state.searchStr&&t.set("name",e.state.searchStr),e.props.history.push("/box?".concat(t.toString()))}},e.toggleSearch=function(){e.setState((function(e){return{isSearchOpen:!e.isSearchOpen}}),(function(){e.state.isSearchOpen&&e.ref.current.focus()}))},e}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){this.checkIfAtDetails()}},{key:"componentDidUpdate",value:function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkIfAtDetails();case 2:this.props.location.search!==t.location.search&&"/"!==this.props.location.pathname&&this.onSetFilter();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.searchStr,n=e.isAtBoxDetails;return r.a.createElement("div",{className:"box-filter flex ".concat(this.props.isShown?"":"invisible"," ").concat(this.state.isSearchOpen?"is-open":"")},r.a.createElement("input",{ref:this.ref,type:"search",className:n?"":"name-filter",name:"name",autoComplete:"off",value:t,onChange:this.onHandleChange,placeholder:n?"Search in playlist":"Search for a Box"}),r.a.createElement(En.a,{className:"search-icon",onClick:this.toggleSearch}))}}]),n}(a.Component),On={setFilter:function(e){return function(t){t({type:"SET_FILTER",filter:e})}}},wn=Object(c.b)((function(e){return{}}),On)(Object(be.f)(Sn));function jn(){return function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.getUser();case 2:n=e.sent,t({type:"SET_USER",user:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var kn=n(438),Nn=n(437),Cn=n(432),Bn=n(436),Un=n(440),Rn=n(443),Dn=n(435),In=n(439),Mn=n(434),Tn=n(433),_n=n(442),Pn=n(431),An=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={user:{username:"",fullName:"",password:"",imgUrl:""}},e.onChange=function(t){e.setState({user:Object(p.a)(Object(p.a)({},e.state.user),{},Object(yt.a)({},t.target.name,t.target.value))})},e.onSignup=function(t){if(t.preventDefault(),""!==e.state.username){var n=e.state.user,a={username:n.username,fullName:n.fullName,password:n.password,imgUrl:n.imgUrl};e.props.signup(a),e.props.loadUser(),e.props.handleClose()}},e}return Object(fe.a)(n,[{key:"uploadImg",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Nt.uploadImg(t);case 2:n=e.sent,a=Nt.makeFaceThumb(n),this.setState((function(e){return{user:Object(p.a)(Object(p.a)({},e.user),{},{imgUrl:a})}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.user;return r.a.createElement("form",{className:"user-add-form flex",onSubmit:this.onSignup},r.a.createElement("div",{className:"inputs flex column"},r.a.createElement("label",null,"User Name:"),r.a.createElement("input",{autoFocus:!0,required:!0,name:"username",type:"text",onChange:this.onChange,placeholder:"User Name:",autoComplete:"off"}),r.a.createElement("label",null,"Full Name:"),r.a.createElement("input",{required:!0,name:"fullName",type:"text",onChange:this.onChange,placeholder:"Full Name",autoComplete:"off"}),r.a.createElement("label",null,"Password:"),r.a.createElement("input",{required:!0,name:"password",type:"password",onChange:this.onChange,placeholder:"Password"}),r.a.createElement(Pn.a,{className:"btn-log",onClick:this.onSignup},"Signup")),r.a.createElement("div",{className:"user-add-thumbnail"},r.a.createElement("label",{className:"upload-label",style:{cursor:"pointer"}},r.a.createElement("input",{onChange:function(t){return e.uploadImg(t)},type:"file",hidden:!0}),r.a.createElement("div",{className:"img-container"},r.a.createElement("img",{src:t.imgUrl||Vt.a,alt:"box"})),r.a.createElement("div",null,t.imgUrl?"":"Upload Image"))))}}]),n}(r.a.Component),Fn={loadUser:jn,signup:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W.signup(e);case 2:a=t.sent,n({type:"SET_USER",user:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Ln=Object(c.b)((function(e){return{user:e.userReducer.loggedinUser}}),Fn)(An),Gn=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){var e;Object(de.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={user:{username:"",password:""}},e.onChange=function(t){e.setState({user:Object(p.a)(Object(p.a)({},e.state.user),{},Object(yt.a)({},t.target.name,t.target.value))})},e.onLogin=function(){var t=Object(f.a)(d.a.mark((function t(n){var a,r,o,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),""!==e.state.username){t.next=3;break}return t.abrupt("return");case 3:return a=e.state.user,r=a.username,o=a.password,s={username:r,password:o},t.next=7,e.props.login(s);case 7:t.sent&&(e.props.loadUser(),e.props.handleClose());case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(fe.a)(n,[{key:"render",value:function(){return r.a.createElement("form",{className:"user-add-form flex",onSubmit:this.onLogin},r.a.createElement("div",{className:"inputs flex column"},r.a.createElement("label",null,"User Name:"),r.a.createElement("input",{autoFocus:!0,name:"username",type:"text",onChange:this.onChange,placeholder:"Your Name",autoComplete:"off"}),r.a.createElement("label",null,"password:"),r.a.createElement("input",{name:"password",type:"password",onChange:this.onChange,placeholder:"Password"}),r.a.createElement(Pn.a,{className:"btn-log",onClick:this.onLogin},"Login")))}}]),n}(r.a.Component),Wn={login:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W.login(e);case 2:return a=t.sent,n({type:"SET_USER",user:a}),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},loadUser:jn},Hn=Object(c.b)((function(e){return{user:e.userReducer.loggedinUser}}),Wn)(Gn);function Xn(e){var t=r.a.useState(!1),n=Object(Ae.a)(t,2),a=n[0],o=n[1],s=function(){o(!1)},c={Signup:Ln,Login:Hn}[e.childern];return c?r.a.createElement("div",{className:"modal-signup"},r.a.createElement("div",{variant:"outlined",color:"primary",onClick:function(){o(!0)}},e.childern),r.a.createElement(In.a,{open:a,onClose:s},r.a.createElement(_n.a,null,e.childern),r.a.createElement(Tn.a,null,r.a.createElement(c,{handleClose:s})),r.a.createElement(Mn.a,null))):r.a.createElement("h1",null,"Loading..")}var zn=Object(Dn.a)((function(e){return{root:{display:"flex"},paper:{marginRight:e.spacing(2)}}}));function qn(e){var t=e.user,n=e.onLogout,a=zn(),o=r.a.useState(!1),s=Object(Ae.a)(o,2),c=s[0],i=s[1],l=r.a.useRef(null);function u(e){e.preventDefault(),n(),i(!1)}var p=function(e){l.current&&l.current.contains(e.target)||i(!1)};return r.a.createElement("div",{className:a.root},r.a.createElement("div",{className:"user-menu"},r.a.createElement(kt.a,{alt:"Remy Sharp",ref:l,src:t.imgUrl,"aria-controls":c?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:function(){i((function(e){return!e}))},style:{cursor:"pointer"}}),r.a.createElement(Bn.a,{open:c,anchorEl:l.current,role:void 0,transition:!0,disablePortal:!0},(function(e){var n=e.TransitionProps,a=e.placement;return r.a.createElement(Nn.a,Object.assign({},n,{style:{transformOrigin:"bottom"===a?"center top":"center bottom"}}),r.a.createElement(Cn.a,null,r.a.createElement(kn.a,{onClickAway:p},r.a.createElement(Rn.a,{autoFocusItem:c,id:"menu-list-grow"},!t.isGuest&&r.a.createElement(Un.a,{onClick:p},r.a.createElement(me.b,{to:"/user/".concat(t._id),style:{color:"black"}},"Profile")),r.a.createElement(Un.a,null,r.a.createElement(Xn,{childern:"Signup"})),r.a.createElement(Un.a,null,r.a.createElement(Xn,{childern:"Login"})),r.a.createElement(Un.a,{onClick:u},"Logout")))))}))))}var Vn=function(e){Object(ge.a)(a,e);var t=Object(he.a)(a);function a(){var e;Object(de.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isScroll:!1,isMobileMenuOpen:!1},e.onScroll=function(){window.scrollY>0?e.setState({isScroll:!0}):e.setState({isScroll:!1})},e.toggleMenu=function(){e.setState({isMobileMenuOpen:!e.state.isMobileMenuOpen})},e.getPathForBoxAdd=function(){var t=e.props.location.pathname;return"/"===t?"/add":t.endsWith("/add")?t:"".concat(t,"/add")},e}return Object(fe.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll)}},{key:"render",value:function(){var e=this.props.user;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{onClick:this.toggleMenu,className:"screen ".concat(this.state.isMobileMenuOpen?"screen-open":"")}),r.a.createElement("header",{onScroll:this.onScroll,className:"".concat(this.state.isScroll?"sticky":""," flex space-between align-center")},"/"===this.props.location.pathname?r.a.createElement("a",{href:"#top"},r.a.createElement("img",{title:"BeatBox",className:"logo",src:n(149),alt:"logo"})):r.a.createElement(me.b,{to:"/"},r.a.createElement("img",{title:"BeatBox",className:"logo",src:n(149),alt:"logo"})),r.a.createElement(wn,{isShown:"/"!==this.props.location.pathname||this.state.isScroll}),r.a.createElement("div",{className:"right-nav flex align-center"},r.a.createElement("ul",{className:"".concat(this.state.isMobileMenuOpen?"menu-open":""," main-nav flex clean-list")},r.a.createElement("li",null,r.a.createElement(me.b,{to:"/box",onClick:this.toggleMenu},"Boxes")),r.a.createElement("li",null,r.a.createElement(me.b,{to:this.getPathForBoxAdd,onClick:this.toggleMenu},"Create Box"))),r.a.createElement("div",{className:"user-avatar"},r.a.createElement(qn,{user:e,onLogout:this.props.logout})),r.a.createElement("button",{className:"menu-btn",onClick:this.toggleMenu},this.state.isMobileMenuOpen?r.a.createElement(vn.a,null):r.a.createElement(hn.a,null)))))}}]),a}(a.Component),Jn={logout:function(){return function(){var e=Object(f.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.logout();case 2:n=W.getUser(),t({type:"SET_USER",user:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},Yn=Object(c.b)((function(e){return{user:e.userReducer.loggedinUser}}),Jn)(Object(be.f)(Vn)),Kn=n(182),Qn=n.n(Kn),Zn=n(183),$n=n.n(Zn),ea=n(184),ta=n.n(ea),na=n(185),aa=n.n(na),ra=n(186),oa=n.n(ra),sa=function(e){Object(ge.a)(a,e);var t=Object(he.a)(a);function a(){var e;Object(de.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isSyncing:!1,isReady:!1,muted:!1,seeking:!1,volume:.75,duration:void 0,secPlayed:0},e.ref=function(t){e.player=t},e.waitForSync=function(t){var n;e.props.currSong===t?setTimeout(e.waitForSync,500):(null===(n=e.props.currSong)||void 0===n?void 0:n.secPlayed)&&(e.setState({isSyncing:!0}),console.log("waiting for ready, status:",e.state.isReady),e.state.isReady?(De.emit("sync song time"),e.setState({isSyncing:!1})):setTimeout(e.waitForSync,1e3))},e.togglePlay=function(){e.props.togglePlay(e.props.currSong)},e.skipToSong=function(t){var n=e.props,a=n.currBox,r=n.currSong,o=a.songs.findIndex((function(e){return e.id===r.id})),s=a.songs.length-1,c=o+t;-1===c?c=s:c>s&&(c=0);var i=a.songs[c].id;e.props.changeSong(i)},e.seekTo=function(t){e.player.seekTo(t)},e.handleSeekMouseDown=function(){e.setState({seeking:!0})},e.handleSeekChange=function(t){var n=t.target;e.setState({secPlayed:parseInt(n.value)})},e.handleSeekMouseUp=function(){e.setState({seeking:!1}),De.emit("update player seek",e.state.secPlayed)},e.handleProgress=function(t){e.state.seeking||e.state.isSyncing||(e.setState({secPlayed:t.playedSeconds}),e.props.updateProgress(t.playedSeconds))},e.handleEnded=function(){e.skipToSong(1)},e.handleDuration=function(t){e.setState({duration:t})},e.onReady=function(){e.setState({isReady:!0})},e.handleVolumeChange=function(t){var n=t.target;e.setState({volume:n.value})},e.toggleMute=function(){e.setState({muted:!e.state.muted})},e}return Object(fe.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){De.on("got seek update",e.seekTo)}),1)}},{key:"componentDidUpdate",value:function(e){var t,n;(null===(t=this.props.currBox)||void 0===t?void 0:t._id)!==(null===(n=e.currBox)||void 0===n?void 0:n._id)&&this.waitForSync(this.props.currSong)}},{key:"render",value:function(){var e=this,t=this.state,a=t.secPlayed,o=t.isSyncing,s=this.props,c=s.currBox,i=s.currSong;if(!c||!i)return null;var l=this.state,u=l.isReady,p=l.volume,m=l.muted,d=l.duration,f=i.isPlaying,g=c.songs.find((function(e){return e.id===i.id}));if(!g)return null;function h(e){var t,n;return e>=60?(t=parseInt(e/60).toString(),n=parseInt(e-60*t).toString().padStart(2,"0")):(t="0",n=parseInt(e).toString().padStart(2,"0")),"".concat(t,":").concat(n)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(Qn.a,{ref:this.ref,className:"player hidden",url:"https://www.youtube.com/watch?v=".concat(null===g||void 0===g?void 0:g.youtubeId),playing:i.isPlaying,controls:!1,volume:p,muted:m,onReady:this.onReady,onEnded:this.handleEnded,onProgress:this.handleProgress,onDuration:this.handleDuration}),r.a.createElement("div",{className:"player-container flex justify-center align-center"},r.a.createElement("div",{className:"player-capsule flex align-center justify-center ".concat(f?"is-playing":"paused")},r.a.createElement("img",{className:"player-thumbnail",src:g.imgUrl,title:g.title,alt:"song thumbnail"}),u?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"player-title"},g.title),r.a.createElement("div",{className:"song-time flex align-center space-between"},r.a.createElement("span",{className:"player-time"},o?"Syncing play...":h(a)),r.a.createElement("input",{className:"duration-slider",style:{},type:"range",name:"played",min:0,max:d,onMouseDown:this.handleSeekMouseDown,onMouseUp:this.handleSeekMouseUp,onChange:this.handleSeekChange,onTouchEnd:this.handleSeekMouseUp,value:a}),d&&r.a.createElement("span",{className:"player-time"},h(d+1)))):r.a.createElement(ve.CircleLoading,{color:"#ac0aff"}),r.a.createElement("div",{className:"player-controls flex align-center"},r.a.createElement("button",{className:"player-ctrl-btn flex align-center",title:"Previous",onClick:function(){return e.skipToSong(-1)}},r.a.createElement($n.a,null)),r.a.createElement("button",{className:"player-ctrl-btn flex align-center",title:f?"Pause":"Play",onClick:this.togglePlay},f?r.a.createElement(mt.a,null):r.a.createElement(ut.a,null)),r.a.createElement("button",{className:"player-ctrl-btn flex align-center",title:"Next",onClick:function(){return e.skipToSong(1)}},r.a.createElement(ta.a,null)),r.a.createElement("input",{className:"volume-slider ".concat(m?"muted":""),type:"range",value:p,min:0,step:.05,max:1,onChange:this.handleVolumeChange}),r.a.createElement("button",{className:"player-ctrl-btn flex justify-center align-center",title:m?"Unmute":"Mute",onClick:this.toggleMute},m?r.a.createElement(aa.a,null):r.a.createElement(oa.a,null)),r.a.createElement("img",{style:{visibility:this.props.location.pathname==="/box/details/".concat(c._id)?"hidden":"visible"},className:"back-to-box",src:n(391),title:"Back to box",alt:"Back to box",onClick:function(){return e.props.history.push("/box/details/".concat(c._id))}})))))}}]),a}(a.Component),ca={changeSong:gt,togglePlay:ft,updateProgress:function(e){return function(t,n){var a=Object(p.a)(Object(p.a)({},n().boxReducer.currSong),{},{secPlayed:e});De.emit("update backend currSong",a),t({type:"SET_CURR_SONG",currSong:a})}}},ia=Object(c.b)((function(e){return{currBox:e.boxReducer.currBox,currSong:e.boxReducer.currSong}}),ca)(Object(be.f)(sa)),la=function(e){Object(ge.a)(n,e);var t=Object(he.a)(n);function n(){return Object(de.a)(this,n),t.apply(this,arguments)}return Object(fe.a)(n,[{key:"componentDidMount",value:function(){this.props.loadBoxes(),De.setup(),De.on("got box status",this.props.setBoxStatus),De.on("joined new box",this.props.loadConnectedUsers),De.on("box changed",this.props.gotBoxUpdate),De.on("chat addMsg",this.props.addMsg),De.on("got player update",this.props.updateLocalPlayer),De.on("got active boxes",this.props.setActiveBoxes)}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Yn,null),r.a.createElement("main",null,r.a.createElement(be.a,{component:Qt,path:"**/add"}),r.a.createElement(be.c,null,r.a.createElement(be.a,{component:Lt,path:"/box/details/:boxId"}),r.a.createElement(be.a,{component:Pe,path:"/user/:id"}),r.a.createElement(be.a,{component:zt,path:"/box"}),r.a.createElement(be.a,{component:fn,path:"/"}))),r.a.createElement(ia,null))}}]),n}(a.Component),ua={setBoxStatus:function(e){var t=e.msgs,n=e.currSong;return function(e,a){var r=a().boxReducer.currBox;n.id||(n=r.songs.length?{id:r.songs[0].id,isPlaying:!0,secPlayed:0}:null),e({type:"SET_CURR_SONG",currSong:n}),e({type:"SET_MSGS",msgs:t})}},gotBoxUpdate:Me,loadConnectedUsers:Pt,addMsg:It,updateLocalPlayer:dt,loadBoxes:Ie,setActiveBoxes:function(e){return function(){var t=Object(f.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e||void 0===e?void 0:e.length){t.next=2;break}return t.abrupt("return");case 2:return a=(a=(a=Object(u.a)(e)).sort((function(e,t){return e.userCount>t.userCount}))).splice(0,3),t.next=7,a.map(function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getById(t.boxId);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:a=t.sent,Promise.all(a).then((function(e){n({type:"SET_ACTIVE_BOXES",boxes:e})}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},pa=Object(c.b)((function(e){return{}}),ua)(la),ma=(n(392),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function da(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:pe},r.a.createElement(me.a,null,r.a.createElement(pa,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ma?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):da(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):da(t,e)}))}}()},86:function(e,t,n){e.exports=n.p+"static/media/img_placeholder.ce927d4c.png"}},[[199,1,2]]]);
//# sourceMappingURL=main.572c04b3.chunk.js.map